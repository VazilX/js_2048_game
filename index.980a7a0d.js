function e(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function r(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.forEach(function(r){var n;n=t[r],r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n})}return e}function n(r){return function(r){if(Array.isArray(r))return e(r)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(r,t){if(r){if("string"==typeof r)return e(r,t);var n=Object.prototype.toString.call(r).slice(8,-1);if("Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(r,t)}}(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var o,i,c=function(){var e,n;function o(){!function(e,r){if(!(e instanceof r))throw TypeError("Cannot call a class as a function")}(this,o),this.numeric=.9>Math.random()?2:4,this.coords=this.findPlase(),this.oldCoords=t({},this.coords),this.canMuve=!0,this.tile=this.addTile(),this.moved=!1,this.combined=!1,o.tiles.push(this)}return e=[{key:"findPlase",value:function(){for(var e=[],r=0;r<o.FIELD_ROWS.length;r++)for(var t=o.FIELD_ROWS[r].children,n=0;n<t.length;n++)t[n].firstChild||e.push({r:r,c:n});if(0===e.length)return!1;var i=e.length-1;return e[Math.floor(Math.random()*(i+1))]}},{key:"addTile",value:function(){var e=this.coords,r=e.r,t=e.c,n=o.FIELD_ROWS[r].children[t];return n.insertAdjacentHTML("beforeend",'\n      <div class="cell cell--'.concat(this.numeric,'">').concat(this.numeric,"</div>\n    ")),n.children[0]}},{key:"checkMoveLeft",value:function(){if(0===this.coords.c)return!1;var e=this.findNeighbourL();return this.checkNeighbour(e)}},{key:"checkMoveRight",value:function(){if(3===this.coords.c)return!1;var e=this.findNeighbourR();return this.checkNeighbour(e)}},{key:"checkMoveTop",value:function(){if(0===this.coords.r)return!1;var e=this.findNeighbourU();return this.checkNeighbour(e)}},{key:"checkMoveBottomn",value:function(){if(3===this.coords.r)return!1;var e=this.findNeighbourB();return this.checkNeighbour(e)}},{key:"checkNeighbour",value:function(e){return!e||e.numeric===this.numeric&&!e.combined&&!this.combined}},{key:"findNeighbourU",value:function(){var e=this.coords,r=e.r,t=e.c;return o.tiles.find(function(e){return e.coords.c===t&&e.coords.r===r-1})}},{key:"findNeighbourB",value:function(){var e=this.coords,r=e.r,t=e.c;return o.tiles.find(function(e){return e.coords.c===t&&e.coords.r===r+1})}},{key:"findNeighbourR",value:function(){var e=this.coords,r=e.r,t=e.c;return o.tiles.find(function(e){return e.coords.r===r&&e.coords.c===t+1})}},{key:"findNeighbourL",value:function(){var e=this.coords,r=e.r,t=e.c;return o.tiles.find(function(e){return e.coords.r===r&&e.coords.c===t-1})}}],r(o.prototype,e),n&&r(o,n),o}();c.FIELD_ROWS=document.querySelectorAll(".field-row"),c.tiles=[];var u=0,a=[],s=document.querySelector(".start"),l=document.querySelector(".restart"),f=document.querySelector(".message-win"),d=document.querySelector(".message-start"),h=document.querySelector(".message-lose");function v(e){document.querySelector(".game-score").innerHTML=e}function m(){a.forEach(function(e){if(e.moved){var r=e.oldCoords,n=r.r,i=r.c;e.tile=e.addTile(),e.combined&&(e.tile.classList.add("combin"),e.combined=!1),c.FIELD_ROWS[n].children[i].innerHTML="",e.moved=!1,e.oldCoords=t({},e.coords),o=null}})}function y(e,r,t){if(e){var n=c.tiles.indexOf(e);e.tile.parentNode.innerHTML="",c.tiles.splice(n,1),e.moved=!1,t.numeric*=2,t.combined=!0,u+=t.numeric,t.numeric>=2042&&f.classList.remove("hidden")}switch(r){case"ArrowUp":t.coords.r-=1;break;case"ArrowLeft":t.coords.c-=1;break;case"ArrowDown":t.coords.r+=1;break;case"ArrowRight":t.coords.c+=1}return t}function b(){return setTimeout(function(){p()},150)}function p(){new c().tile.classList.add("born"),i=null}s.addEventListener("click",function(){l.classList.remove("hidden"),s.classList.add("hidden"),d.classList.add("hidden"),b(),b()}),l.addEventListener("click",function(){f.classList.add("hidden"),h.classList.add("hidden"),document.querySelectorAll(".cell").forEach(function(e){e.parentNode.innerHTML=""}),c.tiles=[],u=0,v(""),b(),b()}),document.addEventListener("keydown",function(e){var r=function(r){var t=[];if("ArrowUp"===e.key){for(var o,i=function(r){c.tiles.filter(function(e){return e.coords.r===r}).forEach(function(r){if(r.checkMoveTop()){var n=r.findNeighbourU();t.push(y(n,e.key,r))}})},u=1;u<4;u++)i(u);if(0===t.length)return"break";t.forEach(function(e){e.tile.style.transform="translateY(calc(-".concat(100*r,"% - ").concat(10*r,"px))"),e.moved=!0}),(o=a).push.apply(o,n(t))}if("ArrowLeft"===e.key){for(var s,l=function(r){c.tiles.filter(function(e){return e.coords.c===r}).forEach(function(r){if(r.checkMoveLeft()){var n=r.findNeighbourL();t.push(y(n,e.key,r))}})},f=1;f<4;f++)l(f);if(0===t.length)return"break";t.forEach(function(e){e.tile.style.transform="translateX(calc(-".concat(100*r,"% - ").concat(10*r,"px))"),e.moved=!0}),(s=a).push.apply(s,n(t))}if("ArrowDown"===e.key){for(var d,h=function(r){c.tiles.filter(function(e){return e.coords.r===r}).forEach(function(r){if(r.checkMoveBottomn()){var n=r.findNeighbourB();t.push(y(n,e.key,r))}})},v=2;v>=0;v--)h(v);if(0===t.length)return"break";t.forEach(function(e){e.tile.style.transform="translateY(calc(".concat(100*r,"% + ").concat(10*r,"px))"),e.moved=!0}),(d=a).push.apply(d,n(t))}if("ArrowRight"===e.key){for(var m,b=function(r){c.tiles.filter(function(e){return e.coords.c===r}).forEach(function(r){if(r.checkMoveRight()){var n=r.findNeighbourR();t.push(y(n,e.key,r))}})},p=2;p>=0;p--)b(p);if(0===t.length)return"break";t.forEach(function(e){e.tile.style.transform="translateX(calc(".concat(100*r,"% + ").concat(10*r,"px))"),e.moved=!0}),(m=a).push.apply(m,n(t))}};o&&(clearTimeout(o),m(a)),i&&(clearTimeout(i),p()),a=[];for(var t=1;t<4&&"break"!==r(t);t++);a.length>0&&(o=setTimeout(function(){m()},100),v(u),i=b()),c.tiles.some(function(e){return e.checkMoveTop()||e.checkMoveBottomn()||e.checkMoveLeft()||e.checkMoveRight()})||(document.querySelector(".game-field").style.opacity="0.5",h.classList.remove("hidden"))});
//# sourceMappingURL=index.980a7a0d.js.map
